@page
@model Dajeej.Pages.RegisterModel
@{
    Layout = "_LayoutInner";
    //Layout = null;
}
<style>
    input[type=submit] {
   
    background:#2296d3 !important; 
    color:white !important;
   
}
</style>


<!-- Page Title
    ============================================= -->
<section id="page-title" class="page-title-parallax" style="background-image: url('public/images/slider/reg1.jpg'); background-position: bottom center; background-size: cover; padding: 80px 0;">

    @*<div class="container clearfix">
        <h1>Register</h1>
        <span>A Short Page Title Tagline</span>
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">Appointment</li>
        </ol>
    </div>*@
      <div class="container clearfix">
        @*<h1>Register</h1>*@
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a ><h1 class="setNewColor">@sharedResource["Register"]</h1></a></li>
           @* <li class="breadcrumb-item active" aria-current="page">Appointment</li>*@
        </ol>
    </div>

</section><!-- #page-title end -->

<section id="content">
    <div class="content-wrap">
        <div class="container clearfix">
            <div class="form-widget">
                <div class="form-result"></div>
                <div class="row">
                   
                    <div class="col-lg-12">
                        <form id="car-rental" enctype="multipart/form-data" method="post" class="row" onsubmit="return validateMyForm();">
                            <div class="form-process">
                                <div class="css3-spinner">
                                    <div class="css3-spinner-scaler"></div>
                                </div>
                            </div>
                            

                            <div class="col-md-4 form-group">
                                <label asp-for="shop.ShopTLEN" for="car-rental-name">@sharedResource["Shop English Title"] <small class="text-danger">*</small></label>
                                <input asp-for="shop.ShopTLEN" type="text"  class="form-control required" placeholder="@sharedResource["Enter Shop English Title"]">
                            </div>
                            <div class="col-md-4 form-group">
                                <label asp-for="shop.ShopTLAR" for="car-rental-contact">@sharedResource["Shop Arabic Title"]<small class="text-danger">*</small></label>
                                <input asp-for="shop.ShopTLAR" type="text"  class="form-control required" placeholder="@sharedResource["Enter Shop Arabic Title"]">
                            </div>
                             <div class="col-md-4 form-group">
                                <label asp-for="shop.ShopNo" for="car-rental-contact">@sharedResource["Shop Number"]<small class="text-danger">*</small></label>
                                <input asp-for="shop.ShopNo" type="text"  class="form-control required" placeholder="@sharedResource["Enter Shop Number"]">
                            </div>
                              <div class="col-md-4 form-group">
                                <label asp-for="shop.Address" for="car-rental-name">@sharedResource["Address"] <small class="text-danger">*</small></label>
                                <input asp-for="shop.Address" type="text"  class="form-control required" placeholder="@sharedResource["Enter Address"]">
                            </div>
                             <div class="col-md-4 form-group">
                                <label asp-for="shop.Mobile" for="car-rental-contact">@sharedResource["Mobile"]<small class="text-danger">*</small></label>
                                <input asp-for="shop.Mobile" type="text"  class="form-control required" placeholder="@sharedResource["Enter Mobile"]">
                            </div>
                              <div class="col-md-4 form-group">
                                <label asp-for="shop.Tele" for="car-rental-name">@sharedResource["Telephone"] <small class="text-danger">*</small></label>
                                <input asp-for="shop.Tele" type="text"  class="form-control required" placeholder="@sharedResource["Enter Telephone"]">
                            </div>
                             <div class="col-md-4 form-group">
                                <label asp-for="shop.DeliveryCost" for="car-rental-contact">@sharedResource["Delivery Cost"]<small class="text-danger">*</small></label>
                                <input asp-for="shop.DeliveryCost" type="text"  class="form-control required" placeholder="@sharedResource["Enter Delivery Cost"]">
                            </div>
                            <div class="col-md-4 form-group">
                                <label asp-for="shop.CountryId" for="car-rental-name">@sharedResource["Country"] <small class="text-danger">*</small></label>

                                <select onchange="changePlansBasedOnCountry(this.selectedIndex)" id="CountryId" asp-for="shop.CountryId" class="form-select required" aria-label="Default select example">
                                    <option selected value="Select Country" >@sharedResource["Select Country"]</option>
                                   
                                    @{
                                         if(@Model.countryList!=null){
                                        foreach (var item in @Model.countryList)

                                        {

                                            <option value="@item.CountryId">@item.CountryTLAR</option>

                                        }
                                         }
                                    }

                                </select>

                            </div>
                            
                            <div class="col-md-4 form-group">
                                <label asp-for="shop.CountryId" for="car-rental-name">@sharedResource["Type"] <small class="text-danger">*</small></label>

                                <select  id="TypeId" asp-for="shop.EntityTypeId" class="form-select required" aria-label="Default select example">
                                    <option selected value="Select Type" >@sharedResource["Select Type"]</option>
                                   
                                    @{
                                         if(@Model.countryList!=null){
                                        foreach (var item in @Model.entityTypeList)

                                        {

                                            <option value="@item.EntityTypeId">@item.TitleAr</option>

                                        }
                                         }
                                    }

                                </select>

                            </div>
                            <div class="col-4 form-group">
                                <label asp-for="shop.Instgram" for="car-rental-email">@sharedResource["Instgram"]<small class="text-danger">*</small></label>
                                <input asp-for="shop.Instgram" type="text"  class="form-control required" required placeholder="@sharedResource["Enter Instgram"]">
                            </div>
                           
                            <div class="col-4 form-group">
                                <label asp-for="shop.Email" for="car-rental-email">@sharedResource["Email"]<small class="text-danger">*</small></label>
                                <input asp-for="shop.Email" type="text"  class="form-control required" required placeholder="@sharedResource["Enter Email"]">
                            </div>
                            <div class="col-4 form-group">
                                <label asp-for="shop.Password" for="car-rental-email">@sharedResource["Password"] <small class="text-danger">*</small></label>
                                <input asp-for="shop.Password" type="password"  class="form-control required" required placeholder="@sharedResource["Enter Password"]">
                            </div>
                             <div class="col-6 form-group">
                                <label asp-for="shop.DescriptionTLEN" for="car-rental-email">@sharedResource["Description In English"] <small class="text-danger">*</small></label>
                                 <textarea class="form-control required" asp-for="shop.DescriptionTLEN" required id="exampleFormControlTextarea1" rows="3" placeholder="@sharedResource["Enter Description In English"]"></textarea>
                               
                            </div>
                             <div class="col-6 form-group">
                                <label asp-for="shop.DescriptionTLAR" for="car-rental-email" >@sharedResource["Description In Arabic"] <small class="text-danger">*</small></label>
                                 <textarea class="form-control required" asp-for="shop.DescriptionTLAR" required id="exampleFormControlTextarea1" rows="3" placeholder="@sharedResource["Enter Description In Arabic"]"></textarea>
                            </div>
                             <div class="col-md-4 form-group">
                                <label for="formFile" class="form-label">@sharedResource["Logo"]</label>
                                <input class="form-control" name="Logo" type="file">
                            </div>
                            <div class="col-md-4 form-group">
                                <label for="formFile" class="form-label">@sharedResource["Banner"]</label>
                                <input class="form-control" name="Banner" type="file">
                            </div>
                             <div class="col-md-4 form-group">
                                <label for="formFile" class="form-label">@sharedResource["Shop Photos"]</label>
                                <input class="form-control" multiple name="MorePhoto" type="file">
                            </div>
                            <div class="col-12 mt-2 mb-3">
                                <div class="card p-3 bg-light">
                                    <div class="car-body">
                                        <h4 class="mb-2">@sharedResource["Location"]</h4>
                                        <div class="form-group row">
                                            <div id="map" style="height:400px;width:800px;margin:auto"></div>
                                            <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCfsM19EfsfREOaCkPjRAVMYdTIXToo0FE&callback=initMap&v=weekly" defer></script>

                                        </div>

                                        <input type="text" asp-for="shop.Lat"  value="" hidden id="LatId" />
                                        <input type="text" asp-for="shop.Lng" value="" hidden id="LngId" />

                                    </div>
                                </div>
                            </div>
                            <div class="col-12 mt-2 mb-3" id="showCard" >
                                <div class="card p-3 bg-light">
                                    <div class="car-body">
                                        <h4 class="mb-2">@sharedResource["Select Plan"]</h4>
                                            <section id="content">
                                                <div class="content-wrap">
                                                    <div class="container clearfix">
                                                        <div class="form-widget">
                                                            <div class="form-result"></div>
                                                            <div class="row">

                                                                <div class="col-lg-12">
                                                                    <div class="form-process">
                                                                        <div class="css3-spinner">
                                                                            <div class="css3-spinner-scaler"></div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-12 form-group ">

                                                                        <div class="row justify-content-center Newitems ">

                                                                        


                                                                        </div>
                                                                    </div>






                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </section>

                                   </div>
                                </div>
                            </div>
                            <div class="col-12 d-none">
                                <input type="text" id="car-rental-botcheck" name="car-rental-botcheck" value="">
                            </div>
                            <div class="col-12 text-center">
                                <input type="submit"  class="btn btn-success btn-lg" value="@sharedResource["Register Now"]" />
                            </div>
                            <input type="number" asp-for="shop.OrderIndex"   hidden  />
                            <input type="date" asp-for="shop.RegisterDate"   hidden  />
                            
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
@section Scripts {
<partial name="_ValidationScriptsPartial" />
}
<script>

                var flag=false;
                function initMap() {
                     var markers = [];
                     var uniqueId = 1;
                    var myLatlng = { lat: 29.378586, lng: 47.990341 };
                    var map = new google.maps.Map(document.getElementById("map"), {
                        zoom: 4,
                        center: myLatlng,
                    });

                    var infoWindow = new google.maps.InfoWindow({
                        content: "Select Location",
                        position: myLatlng,
                    });

                    infoWindow.open(map);
                    map.addListener("click", function (mapsMouseEvent) {


                      var jsonobj=JSON.stringify(mapsMouseEvent.latLng.toJSON());
                      var myObj = JSON.parse(jsonobj);
                        sendReq(myObj);
                        var MarkerObj={lat: myObj.lat, lng: myObj.lng};
                        var marker = new google.maps.Marker({
                            position: MarkerObj,
                            map: map
                        });
                        marker.id = uniqueId;
                        uniqueId++;
                        markers.push(marker);
                           for (var i = 0; i < markers.length; i++) {
                        if (markers[i].id == marker.id-1) {
                            markers[i].setMap(null);
                            markers.splice(i, 1);
                            return;
                        }
                    }
                        infoWindow.open(map, marker);
                        infoWindow.close();
                    infoWindow = new google.maps.InfoWindow({
                            position: mapsMouseEvent.latLng,
                        });

                            });

                }
                window.initMap = initMap;
                function sendReq(obj){
                    flag=true;
                    console.log(obj);
                    document.getElementById("LatId").value=obj.lat;
                    document.getElementById("LngId").value=obj.lng;
                    }
                    function validateMyForm() {
                    console.log(flag);
                    if(flag==false){
                        alert("You Must Select Location From Map");
                        return false;
                    }
                    CountryId=document.getElementById("CountryId").value;
                    if(CountryId=="Select Country"){
                         alert("You Must Select Country");
                        return false;
                    }
                    TypeId=document.getElementById("TypeId").value;
                    if(CountryId=="Select Type"){
                         alert("You Must Select Type");
                        return false;
                    }
                    
                    var SelcValue=document.querySelector('input[name="selectedValue"]:checked').value;
                    console.log("Selected Plan = "+SelcValue);

                    }

                    
     var allPlans = null;

      window.addEventListener("load", () => {
           //var showCardId=document.getElementById("showCard");
           //showCardId.style.display = "none";
          fetch("@Model.url" + "/api/Plans/GetPlansForIndexPage" )
    .then(response => response.json())
    .then(data => {
        console.log(data);
        allPlans = data;
        console.log("all plans", allPlans);
       
       
    });
      })


    function changePlansBasedOnCountry(val) {
        debugger
          console.log("we are in ")
          console.log(val)
          
          document.getElementsByClassName("Newitems")[0].innerHTML = "";
           
        for (const property in allPlans.data) {
              if(allPlans.data[property].CountryId == val){
      document.getElementsByClassName("Newitems")[0].innerHTML += `
       <label for="data-plan-starter" class="col-sm-6 col-md-4">
                     <div class="pricing-box text-center shadow-none border">
                     <input type="radio"  class="required mt-3" id="data-plan-starter" checked name="selectedValue" required  autocomplete="off" data-price="30" value="${allPlans.data[property].PlanId}">
                      <div class="pricing-title bg-transparent">
												<h3 class="nott ls0">${allPlans.data[property].EnglishTitle}</h3>
											</div> 
				 
                                
								<div class="pricing-price">
												<span class="price-unit">${allPlans.data[property].Price}<span >/KD</span>
								</div>
                                <span class="nott ls0">${allPlans.data[property].Period} Mo </span>

                             
                           <div class="pricing-features border-0 bg-transparent">
												<ul>
                                <li class="nott ls0 fw-normal">${allPlans.data[property].NoOfItems} @sharedResource["Items"] </li>
                                 <li class="nott ls0 fw-normal">${allPlans.data[property].Reports == true ? " <i class='fas fa-check'></i> @sharedResource["Reports"]" : " <i class='fas fa-times'></i> Reports" }</li>
                                 <li class="nott ls0 fw-normal">${allPlans.data[property].Dashboard == true ? " <i class='fas fa-check'></i>@sharedResource["Dashboard"] " : " <i class='fas fa-times'></i> Dashboard" }</li>
                                 <li class="nott ls0 fw-normal">${allPlans.data[property].AdzBanners == true ? " <i class='fas fa-check'></i> @sharedResource["AdzBanners"]" : " <i class='fas fa-times'></i> AdzBanners" }</li>
                                 <li class="nott ls0 fw-normal">${allPlans.data[property].VipCollection == true ? " <i class='fas fa-check'></i>@sharedResource["VipCollection"] " : " <i class='fas fa-times'></i> VipCollection" }</li>


                            </ul>
							</div>
							
                            
                             </div>
                    </label>
					</div>
				</div>
			</div>
		</div>
	</div>
                
      `;
  }
}
}

</script>